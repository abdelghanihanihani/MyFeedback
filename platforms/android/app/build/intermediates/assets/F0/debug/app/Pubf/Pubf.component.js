"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var sidedrawer_1 = require("nativescript-pro-ui/sidedrawer");
var angular_1 = require("nativescript-pro-ui/sidedrawer/angular");
var employee_service_1 = require("./../services/employee/employee.service");
var project_service_1 = require("./../services/project/project.service");
var feedback_service_1 = require("./../services/feedback/feedback.service");
var PubfComponent = /** @class */ (function () {
    //ErrorOther:boolean= this.other=="";
    function PubfComponent(EmployeeService, ProjectService, FeedbackService) {
        var _this = this;
        this.EmployeeService = EmployeeService;
        this.ProjectService = ProjectService;
        this.FeedbackService = FeedbackService;
        this.selectedContextType = 0;
        this.selectedContext = 0;
        this.selectedType = 0;
        this.selectedMode = 0;
        this.Modes = ["Public", "Private", "Personalized"];
        this.Types = ["Positive", "NÃ©gative"];
        this.ListOfContexts = ["Employee", "Project", "Other"];
        this.Contexts = [];
        this.Targets = [this.EmployeeService.getEmployee()];
        this.Other = false;
        this.Context = "Employee :";
        this.ErrorOther = false;
        this.List = false;
        this.feedback = { id: null, contextType: 'Employee', context: '', type: 'Positive', mode: 'Public', value: '', date: '', targets: null };
        // fdpb:{id_e:number,feedback:Feedback}={id_e:null,feedback:this.feedback};
        // list:Array<{status:boolean,employee:Employee}>=[];
        this.count = 0;
        this.isBusy = false;
        this.selectedContext == 0;
        // this.Contexts=[];
        this.feedback.targets = [];
        this.EmployeeService.getAllEmployees().subscribe(function (next) {
            _this.ListOfEmployee = next;
            for (var i = 0; i <= _this.ListOfEmployee.length; i++) {
                _this.Contexts.push(_this.ListOfEmployee[i].firstname + " " + _this.ListOfEmployee[i].lastname);
                _this.Targets.push(_this.ListOfEmployee[i].id);
                // this.list[i].status=false;
                // this.list[i].employee=this.ListOfEmployee[i];
            }
        });
        this.ProjectService.getAllProjects().subscribe(function (next) { _this.ListOfProjects = next; });
    }
    PubfComponent.prototype.ngOnInit = function () {
        this._sideDrawerTransition = new sidedrawer_1.SlideInOnTopTransition();
    };
    Object.defineProperty(PubfComponent.prototype, "sideDrawerTransition", {
        get: function () {
            return this._sideDrawerTransition;
        },
        enumerable: true,
        configurable: true
    });
    PubfComponent.prototype.onDrawerButtonTap = function () {
        this.drawerComponent.sideDrawer.showDrawer();
    };
    PubfComponent.prototype.OnChangeContextType = function (args) {
        if (args.newIndex == 0) {
            this.feedback.contextType = this.ListOfContexts[args.newIndex];
            this.Context = "Employee :";
            this.Other = false;
            this.Contexts = [];
            for (var i = 0; i <= this.ListOfEmployee.length; i++) {
                this.Contexts.push(this.ListOfEmployee[i].firstname + " " + this.ListOfEmployee[i].lastname);
            }
        }
        else if (args.newIndex == 1) {
            this.feedback.contextType = this.ListOfContexts[args.newIndex];
            this.Context = "Project :";
            this.Other = false;
            this.Contexts = [];
            for (var i = 0; i <= this.ListOfProjects.length; i++) {
                this.Contexts.push(this.ListOfProjects[i].name);
            }
        }
        else if (args.newIndex == 2) {
            //this.feedback.context=this.other;
            this.Other = true;
            this.ErrorOther = true;
            this.feedback.contextType = this.ListOfContexts[args.newIndex];
        }
    };
    PubfComponent.prototype.onTextChange = function (args) {
        var textField = args.object;
        this.other = textField.text;
    };
    PubfComponent.prototype.OnChangeContext = function (args) {
        this.feedback.context = this.Contexts[args.newIndex];
    };
    PubfComponent.prototype.OnChangeType = function (args) {
        this.feedback.type = this.Types[args.newIndex];
    };
    PubfComponent.prototype.OnChangeMode = function (args) {
        this.feedback.mode = this.Modes[args.newIndex];
        if (args.newIndex == 0) {
            this.Targets = [this.EmployeeService.getEmployee()];
            for (var i = 0; i <= this.ListOfEmployee.length; i++) {
                this.Targets.push(this.ListOfEmployee[i].id);
            }
        }
        else if (args.newIndex == 1) {
            this.Targets = [this.EmployeeService.getEmployee()];
        }
        else if (args.newIndex == 2) {
            this.Targets = [this.EmployeeService.getEmployee()];
            this.count = this.Targets.length;
            this.List = true;
        }
    };
    PubfComponent.prototype.onSetupItemView = function (args) {
        args.view.context.third = (args.index % 3 === 0);
    };
    PubfComponent.prototype.onItemTap = function (args) {
        //this.isTaped=!this.isTaped;
        // if((this.list[args.index].status==false)&&(this.list[args.index].employee==this.ListOfEmployee[args.index]))
        // {this.list[args.index].status=! this.list[args.index].status;
        //     this.isTaped=true;}
        //alert(args.view);
        this.isAdded = this.searchById(this.ListOfEmployee[args.index].id);
        if (this.isAdded == -1) {
            this.Targets.push(this.ListOfEmployee[args.index].id);
            this.count = this.Targets.length;
        }
        else {
            this.Targets.splice(this.isAdded, 1);
            alert({ title: "Remind", message: this.ListOfEmployee[args.index].firstname + " " + this.ListOfEmployee[args.index].lastname + " is removed", okButtonText: "OK" });
            this.count = this.Targets.length;
        }
        //    alert('Item with index: ' + args.index + ' tapped');
    };
    PubfComponent.prototype.submit = function (text) {
        if (text == '') {
            this.ErrorOther = true;
        }
        else {
            this.other = text;
            this.ErrorOther = false;
        }
    };
    PubfComponent.prototype.reset = function () {
        this.Context = "Employee :";
        this.selectedContext = 0;
        this.other = '';
        this.selectedType = 0;
        this.selectedMode = 0;
        this.feedback.value = '';
        this.resetTargets();
        this.selectedContextType = 0;
        this.Other = false;
        this.Contexts = [];
        for (var i = 0; i <= this.ListOfEmployee.length; i++) {
            this.Contexts.push(this.ListOfEmployee[i].firstname + " " + this.ListOfEmployee[i].lastname);
        }
    };
    PubfComponent.prototype.publish = function () {
        var _this = this;
        if (this.feedback.contextType == 'Other') {
            this.feedback.context = this.other;
        }
        var date = new Date();
        var day = date.getDate();
        var month = date.getMonth() + 1;
        var year = date.getFullYear();
        this.feedback.date = day + '/' + month + '/' + year;
        // this.Targets.push(this.EmployeeService.getEmployee());
        this.feedback.targets = this.Targets;
        //this.feedback.context=this.other;
        //this.fdpb.id_e=this.EmployeeService.getEmployee();
        this.isBusy = true;
        this.FeedbackService.addFeedback(this.feedback).subscribe(function (next) {
            _this.isBusy = false;
            alert("Your feedback is added successfully");
        }, 
        //alert(JSON.stringify(next));},
        function (error) {
            _this.isBusy = false;
            alert("Unfortunately we were unable to add your feedback.");
        });
    };
    PubfComponent.prototype.finish = function () {
        this.List = false;
        if (this.Targets.length == 0) {
            this.selectedMode = 0;
            for (var i = 0; i <= this.ListOfEmployee.length; i++) {
                this.Targets.push(this.ListOfEmployee[i].id);
            }
        }
        else {
            this.selectedMode = 2;
            // this.feedback.targets=this.Targets
        }
    };
    PubfComponent.prototype.resetTargets = function () {
        this.Targets = [this.EmployeeService.getEmployee()];
        this.count = this.Targets.length;
    };
    PubfComponent.prototype.searchById = function (id) {
        var i = 0;
        while ((this.Targets[i] != id) && (i <= this.Targets.length)) {
            i++;
        }
        if (i > this.Targets.length) {
            return -1;
        }
        else {
            return i;
        }
    };
    __decorate([
        core_1.ViewChild("CB1"),
        __metadata("design:type", core_1.ElementRef)
    ], PubfComponent.prototype, "FirstCheckBox", void 0);
    __decorate([
        core_1.ViewChild("drawer"),
        __metadata("design:type", angular_1.RadSideDrawerComponent)
    ], PubfComponent.prototype, "drawerComponent", void 0);
    PubfComponent = __decorate([
        core_1.Component({
            selector: "Pubf",
            moduleId: module.id,
            templateUrl: "./Pubf.component.html",
            styleUrls: ["./Pubf.component.css"],
            providers: [employee_service_1.EmployeeService, project_service_1.ProjectService, feedback_service_1.FeedbackService]
        }),
        __metadata("design:paramtypes", [employee_service_1.EmployeeService, project_service_1.ProjectService, feedback_service_1.FeedbackService])
    ], PubfComponent);
    return PubfComponent;
}());
exports.PubfComponent = PubfComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHViZi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJQdWJmLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFDLHNDQUF3RTtBQUN6RSw2REFBOEY7QUFDOUYsa0VBQWdGO0FBR2hGLDRFQUEwRTtBQUUxRSx5RUFBc0U7QUFHdEUsNEVBQTBFO0FBVzFFO0lBMEJJLHFDQUFxQztJQUNyQyx1QkFBb0IsZUFBK0IsRUFBUyxjQUE2QixFQUFTLGVBQStCO1FBQWpJLGlCQXFCQztRQXJCbUIsb0JBQWUsR0FBZixlQUFlLENBQWdCO1FBQVMsbUJBQWMsR0FBZCxjQUFjLENBQWU7UUFBUyxvQkFBZSxHQUFmLGVBQWUsQ0FBZ0I7UUExQmpJLHdCQUFtQixHQUFRLENBQUMsQ0FBQztRQUM3QixvQkFBZSxHQUFRLENBQUMsQ0FBQztRQUN6QixpQkFBWSxHQUFRLENBQUMsQ0FBQztRQUN0QixpQkFBWSxHQUFRLENBQUMsQ0FBQztRQUN0QixVQUFLLEdBQWUsQ0FBQyxRQUFRLEVBQUMsU0FBUyxFQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ3hELFVBQUssR0FBZSxDQUFDLFVBQVUsRUFBQyxVQUFVLENBQUMsQ0FBQztRQUM1QyxtQkFBYyxHQUFlLENBQUMsVUFBVSxFQUFDLFNBQVMsRUFBQyxPQUFPLENBQUMsQ0FBQztRQUc1RCxhQUFRLEdBQWUsRUFBRSxDQUFDO1FBQzFCLFlBQU8sR0FBZSxDQUFDLElBQUksQ0FBQyxlQUFlLENBQUMsV0FBVyxFQUFFLENBQUMsQ0FBQztRQUMzRCxVQUFLLEdBQVMsS0FBSyxDQUFDO1FBQ3BCLFlBQU8sR0FBUSxZQUFZLENBQUM7UUFHNUIsZUFBVSxHQUFTLEtBQUssQ0FBQztRQUN6QixTQUFJLEdBQVMsS0FBSyxDQUFDO1FBQ25CLGFBQVEsR0FBVSxFQUFDLEVBQUUsRUFBQyxJQUFJLEVBQUMsV0FBVyxFQUFDLFVBQVUsRUFBQyxPQUFPLEVBQUMsRUFBRSxFQUFDLElBQUksRUFBQyxVQUFV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LENBQUM7WUFBQSxNQUFNLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFBQSxDQUFDO1FBQ1osSUFBSSxDQUNMLENBQUM7WUFBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1FBQUEsQ0FBQztJQUVkLENBQUM7SUFyTmM7UUFBakIsZ0JBQVMsQ0FBQyxLQUFLLENBQUM7a0NBQWdCLGlCQUFVO3dEQUFDO0lBd0J2QjtRQUFwQixnQkFBUyxDQUFDLFFBQVEsQ0FBQztrQ0FBa0IsZ0NBQXNCOzBEQUFDO0lBakRwRCxhQUFhO1FBUHpCLGdCQUFTLENBQUM7WUFDTixRQUFRLEVBQUUsTUFBTTtZQUNoQixRQUFRLEVBQUUsTUFBTSxDQUFDLEVBQUU7WUFDbkIsV0FBVyxFQUFFLHVCQUF1QjtZQUNwQyxTQUFTLEVBQUUsQ0FBQyxzQkFBc0IsQ0FBQztZQUNuQyxTQUFTLEVBQUMsQ0FBQyxrQ0FBZSxFQUFDLGdDQUFjLEVBQUMsa0NBQWUsQ0FBQztTQUM5RCxDQUFDO3lDQTRCc0Msa0NBQWUsRUFBd0IsZ0NBQWMsRUFBeUIsa0NBQWU7T0EzQnhILGFBQWEsQ0FxUHpCO0lBQUQsb0JBQUM7Q0FBQSxBQXJQRCxJQXFQQztBQXJQWSxzQ0FBYSIsInNvdXJjZXNDb250ZW50IjpbIiBpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCxWaWV3Q2hpbGQsRWxlbWVudFJlZiAgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0IHsgRHJhd2VyVHJhbnNpdGlvbkJhc2UsIFNsaWRlSW5PblRvcFRyYW5zaXRpb24gfSBmcm9tIFwibmF0aXZlc2NyaXB0LXByby11aS9zaWRlZHJhd2VyXCI7XG5pbXBvcnQgeyBSYWRTaWRlRHJhd2VyQ29tcG9uZW50IH0gZnJvbSBcIm5hdGl2ZXNjcmlwdC1wcm8tdWkvc2lkZWRyYXdlci9hbmd1bGFyXCI7XG5pbXBvcnQgeyBTZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50RGF0YSB9IGZyb20gXCJuYXRpdmVzY3JpcHQtZHJvcC1kb3duXCI7XG5pbXBvcnQgeyBUZXh0RmllbGQgfSBmcm9tIFwidWkvdGV4dC1maWVsZFwiO1xuaW1wb3J0IHsgRW1wbG95ZWVTZXJ2aWNlIH0gZnJvbSBcIi4vLi4vc2VydmljZXMvZW1wbG95ZWUvZW1wbG95ZWUuc2VydmljZVwiO1xuaW1wb3J0IHsgRW1wbG95ZWUgfSBmcm9tIFwiLi8uLi9zZXJ2aWNlcy9lbXBsb3llZS9lbXBsb3llZS5tb2RlbFwiO1xuaW1wb3J0IHsgUHJvamVjdFNlcnZpY2V9IGZyb20gXCIuLy4uL3NlcnZpY2VzL3Byb2plY3QvcHJvamVjdC5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4vLi4vc2VydmljZXMvcHJvamVjdC9wcm9qZWN0Lm1vZGVsXCI7XG5pbXBvcnQgeyBGZWVkYmFjayB9IGZyb20gXCIuLy4uL3NlcnZpY2VzL2ZlZWRiYWNrL2ZlZWRiYWNrLm1vZGVsXCI7XG5pbXBvcnQgeyBGZWVkYmFja1NlcnZpY2UgfSBmcm9tIFwiLi8uLi9zZXJ2aWNlcy9mZWVkYmFjay9mZWVkYmFjay5zZXJ2aWNlXCI7XG5pbXBvcnQgeyBJdGVtRXZlbnREYXRhIH0gZnJvbSBcInVpL2xpc3Qtdmlld1wiO1xuaW1wb3J0IHtTZXR1cEl0ZW1WaWV3QXJnc30gZnJvbSBcIm5hdGl2ZXNjcmlwdC1hbmd1bGFyL2RpcmVjdGl2ZXNcIjtcblxuQENvbXBvbmVudCh7XG4gICAgIHNlbGVjdG9yOiBcIlB1YmZcIixcbiAgICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICAgdGVtcGxhdGVVcmw6IFwiLi9QdWJmLmNvbXBvbmVudC5odG1sXCIsXG4gICAgIHN0eWxlVXJsczogW1wiLi9QdWJmLmNvbXBvbmVudC5jc3NcIl0sXG4gICAgIHByb3ZpZGVyczpbRW1wbG95ZWVTZXJ2aWNlLFByb2plY3RTZXJ2aWNlLEZlZWRiYWNrU2VydmljZV1cbn0pXG5leHBvcnQgY2xhc3MgUHViZkNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgc2VsZWN0ZWRDb250ZXh0VHlwZTpudW1iZXI9MDtcbiAgICBzZWxlY3RlZENvbnRleHQ6bnVtYmVyPTA7XG4gICAgc2VsZWN0ZWRUeXBlOm51bWJlcj0wO1xuICAgIHNlbGVjdGVkTW9kZTpudW1iZXI9MDtcbiAgICBNb2RlczpBcnJheTxzdHJpbmc+PVtcIlB1YmxpY1wiLFwiUHJpdmF0ZVwiLFwiUGVyc29uYWxpemVkXCJdO1xuICAgIFR5cGVzOkFycmF5PHN0cmluZz49W1wiUG9zaXRpdmVcIixcIk7DqWdhdGl2ZVwiXTtcbiAgICBMaXN0T2ZDb250ZXh0czpBcnJheTxzdHJpbmc+PVtcIkVtcGxveWVlXCIsXCJQcm9qZWN0XCIsXCJPdGhlclwiXTtcbiAgICBMaXN0T2ZFbXBsb3llZTpBcnJheTxFbXBsb3llZT47XG4gICAgTGlzdE9mUHJvamVjdHM6QXJyYXk8UHJvamVjdD47XG4gICAgQ29udGV4dHM6QXJyYXk8c3RyaW5nPj1bXTtcbiAgICBUYXJnZXRzOkFycmF5PG51bWJlcj49W3RoaXMuRW1wbG95ZWVTZXJ2aWNlLmdldEVtcGxveWVlKCldO1xuICAgIE90aGVyOmJvb2xlYW49ZmFsc2U7XG4gICAgQ29udGV4dDpzdHJpbmc9XCJFbXBsb3llZSA6XCI7XG4gICAgcGFzc3dvcmQ6c3RyaW5nO1xuICAgIG90aGVyOnN0cmluZztcbiAgICBFcnJvck90aGVyOmJvb2xlYW49ZmFsc2U7XG4gICAgTGlzdDpib29sZWFuPWZhbHNlO1xuICAgIGZlZWRiYWNrOkZlZWRiYWNrPXtpZDpudWxsLGNvbnRleHRUeXBlOidFbXBsb3llZScsY29udGV4dDonJyx0eXBlOidQb3NpdGl2ZScsbW9kZTonUHVibGljJyx2YWx1ZTonJyxkYXRlOicnLHRhcmdldHM6bnVsbH07XG4gICAgLy8gZmRwYjp7aWRfZTpudW1iZXIsZmVlZGJhY2s6RmVlZGJhY2t9PXtpZF9lOm51bGwsZmVlZGJhY2s6dGhpcy5mZWVkYmFja307XG4gICAgLy8gbGlzdDpBcnJheTx7c3RhdHVzOmJvb2xlYW4sZW1wbG95ZWU6RW1wbG95ZWV9Pj1bXTtcbiAgICBjb3VudDpudW1iZXI9MDtcbiAgICBpc0FkZGVkOm51bWJlcjtcbiAgICBpc0J1c3k6Ym9vbGVhbj1mYWxzZTtcbiAgICBpc1RhcGVkOmJvb2xlYW47XG4gICAgQFZpZXdDaGlsZChcIkNCMVwiKSBGaXJzdENoZWNrQm94OiBFbGVtZW50UmVmO1xuICAgIC8vRXJyb3JPdGhlcjpib29sZWFuPSB0aGlzLm90aGVyPT1cIlwiO1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgRW1wbG95ZWVTZXJ2aWNlOkVtcGxveWVlU2VydmljZSxwcml2YXRlIFByb2plY3RTZXJ2aWNlOlByb2plY3RTZXJ2aWNlLHByaXZhdGUgRmVlZGJhY2tTZXJ2aWNlOkZlZWRiYWNrU2VydmljZSl7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDb250ZXh0PT0wO1xuICAgICAgIC8vIHRoaXMuQ29udGV4dHM9W107XG4gICAgICAgIHRoaXMuZmVlZGJhY2sudGFyZ2V0cz1bXTtcbiAgICAgICAgdGhpcy5FbXBsb3llZVNlcnZpY2UuZ2V0QWxsRW1wbG95ZWVzKCkuc3Vic2NyaWJlKFxuICAgICAgICAgICAgbmV4dCA9Pnt0aGlzLkxpc3RPZkVtcGxveWVlPW5leHQ7XG4gICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTA7aTw9dGhpcy5MaXN0T2ZFbXBsb3llZS5sZW5ndGg7aSsrKVxuICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICB0aGlzLkNvbnRleHRzLnB1c2godGhpcy5MaXN0T2ZFbXBsb3llZVtpXS5maXJzdG5hbWUrXCIgXCIrdGhpcy5MaXN0T2ZFbXBsb3llZVtpXS5sYXN0bmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuVGFyZ2V0cy5wdXNoKHRoaXMuTGlzdE9mRW1wbG95ZWVbaV0uaWQpO1xuICAgICAgICAgICAgICAgIC8vIHRoaXMubGlzdFtpXS5zdGF0dXM9ZmFsc2U7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5saXN0W2ldLmVtcGxveWVlPXRoaXMuTGlzdE9mRW1wbG95ZWVbaV07XG4gICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgdGhpcy5Qcm9qZWN0U2VydmljZS5nZXRBbGxQcm9qZWN0cygpLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICBuZXh0ID0+e3RoaXMuTGlzdE9mUHJvamVjdHM9bmV4dDt9KTtcbiAgICAgICAgICAgICAgICBcbiAgICB9XG4gICAgQFZpZXdDaGlsZChcImRyYXdlclwiKSBkcmF3ZXJDb21wb25lbnQ6IFJhZFNpZGVEcmF3ZXJDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBfc2lkZURyYXdlclRyYW5zaXRpb246IERyYXdlclRyYW5zaXRpb25CYXNlO1xuICAgIG5nT25Jbml0KCk6IHZvaWQge1xuICAgICAgICB0aGlzLl9zaWRlRHJhd2VyVHJhbnNpdGlvbiA9IG5ldyBTbGlkZUluT25Ub3BUcmFuc2l0aW9uKCk7XG4gICAgICAgIFxuICAgIH1cbiAgICBnZXQgc2lkZURyYXdlclRyYW5zaXRpb24oKTogRHJhd2VyVHJhbnNpdGlvbkJhc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5fc2lkZURyYXdlclRyYW5zaXRpb247XG4gICAgfVxuICAgIG9uRHJhd2VyQnV0dG9uVGFwKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmRyYXdlckNvbXBvbmVudC5zaWRlRHJhd2VyLnNob3dEcmF3ZXIoKTtcbiAgICB9XG4gICAgT25DaGFuZ2VDb250ZXh0VHlwZShhcmdzOiBTZWxlY3RlZEluZGV4Q2hhbmdlZEV2ZW50RGF0YSkgXG4gICAgIHtcbiAgICAgICAgIGlmKGFyZ3MubmV3SW5kZXg9PTApXG4gICAgICAgICB7Ly90aGlzLkVycm9yT3RoZXI9ZmFsc2U7XG4gICAgICAgICAgICAgdGhpcy5mZWVkYmFjay5jb250ZXh0VHlwZT10aGlzLkxpc3RPZkNvbnRleHRzW2FyZ3MubmV3SW5kZXhdO1xuICAgICAgICAgICAgIHRoaXMuQ29udGV4dD1cIkVtcGxveWVlIDpcIjtcbiAgICAgICAgICAgICB0aGlzLk90aGVyPWZhbHNlO1xuICAgICAgICAgICAgIHRoaXMuQ29udGV4dHM9W107XG4gICAgICAgICAgICAgZm9yKGxldCBpPTA7aTw9dGhpcy5MaXN0T2ZFbXBsb3llZS5sZW5ndGg7aSsrKVxuICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgdGhpcy5Db250ZXh0cy5wdXNoKHRoaXMuTGlzdE9mRW1wbG95ZWVbaV0uZmlyc3RuYW1lK1wiIFwiK3RoaXMuTGlzdE9mRW1wbG95ZWVbaV0ubGFzdG5hbWUpO1xuICAgICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYoYXJncy5uZXdJbmRleD09MSlcbiAgICAgICAgIHsgICAvL3RoaXMuRXJyb3JPdGhlcj1mYWxzZTtcbiAgICAgICAgICAgICB0aGlzLmZlZWRiYWNrLmNvbnRleHRUeXBlPXRoaXMuTGlzdE9mQ29udGV4dHNbYXJncy5uZXdJbmRleF07XG4gICAgICAgICAgICAgdGhpcy5Db250ZXh0PVwiUHJvamVjdCA6XCI7XG4gICAgICAgICB0aGlzLk90aGVyPWZhbHNlO1xuICAgICAgICAgICAgIHRoaXMuQ29udGV4dHM9W107XG4gICAgICAgICAgICBmb3IobGV0IGk9MDtpPD10aGlzLkxpc3RPZlByb2plY3RzLmxlbmd0aDtpKyspXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5Db250ZXh0cy5wdXNoKHRoaXMuTGlzdE9mUHJvamVjdHNbaV0ubmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAgICBcbiAgICAgICAgIH1cbiAgICAgICAgIGVsc2UgaWYoYXJncy5uZXdJbmRleD09MilcbiAgICAgICAgIHtcbiAgICAgICAgICAgIC8vdGhpcy5mZWVkYmFjay5jb250ZXh0PXRoaXMub3RoZXI7XG4gICAgICAgICAgICB0aGlzLk90aGVyPXRydWU7XG4gICAgICAgICAgICB0aGlzLkVycm9yT3RoZXI9dHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2suY29udGV4dFR5cGU9dGhpcy5MaXN0T2ZDb250ZXh0c1thcmdzLm5ld0luZGV4XTtcblxuICAgICAgICAgICAgXG4gICAgICAgICB9XG4gICAgICAgICBcbiAgICAgICAgfVxuICAgICAgICBwdWJsaWMgb25UZXh0Q2hhbmdlKGFyZ3MpIHtcbiAgICAgICAgICAgIGxldCB0ZXh0RmllbGQgPSA8VGV4dEZpZWxkPmFyZ3Mub2JqZWN0O1xuICAgICAgICAgICAgdGhpcy5vdGhlciA9IHRleHRGaWVsZC50ZXh0O1xuICAgICAgICB9XG4gICAgICAgIE9uQ2hhbmdlQ29udGV4dChhcmdzOlNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnREYXRhKXtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2suY29udGV4dD10aGlzLkNvbnRleHRzW2FyZ3MubmV3SW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIE9uQ2hhbmdlVHlwZShhcmdzOlNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnREYXRhKXtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2sudHlwZT10aGlzLlR5cGVzW2FyZ3MubmV3SW5kZXhdO1xuICAgICAgICB9XG4gICAgICAgIE9uQ2hhbmdlTW9kZShhcmdzOlNlbGVjdGVkSW5kZXhDaGFuZ2VkRXZlbnREYXRhKXtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2subW9kZT10aGlzLk1vZGVzW2FyZ3MubmV3SW5kZXhdO1xuICAgICAgICAgICAgaWYoYXJncy5uZXdJbmRleD09MClcbiAgICAgICAgICAgIHt0aGlzLlRhcmdldHM9W3RoaXMuRW1wbG95ZWVTZXJ2aWNlLmdldEVtcGxveWVlKCldO1xuICAgICAgICAgICAgICAgIGZvcihsZXQgaT0wO2k8PXRoaXMuTGlzdE9mRW1wbG95ZWUubGVuZ3RoO2krKylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICB0aGlzLlRhcmdldHMucHVzaCh0aGlzLkxpc3RPZkVtcGxveWVlW2ldLmlkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmKGFyZ3MubmV3SW5kZXg9PTEpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5UYXJnZXRzPVt0aGlzLkVtcGxveWVlU2VydmljZS5nZXRFbXBsb3llZSgpXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYoYXJncy5uZXdJbmRleD09MilcbiAgICAgICAgICAgIHt0aGlzLlRhcmdldHM9W3RoaXMuRW1wbG95ZWVTZXJ2aWNlLmdldEVtcGxveWVlKCldO1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnQ9dGhpcy5UYXJnZXRzLmxlbmd0aDtcbiAgICAgICAgICAgICAgICB0aGlzLkxpc3Q9dHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBvblNldHVwSXRlbVZpZXcoYXJnczogU2V0dXBJdGVtVmlld0FyZ3MpIHtcbiAgICAgICAgICAgIGFyZ3Mudmlldy5jb250ZXh0LnRoaXJkID0gKGFyZ3MuaW5kZXggJSAzID09PSAwKTtcbiAgICAgICAgfVxuICAgICAgICBvbkl0ZW1UYXAoYXJnczogSXRlbUV2ZW50RGF0YSk6IHZvaWQge1xuICAgICAgICAgICAgLy90aGlzLmlzVGFwZWQ9IXRoaXMuaXNUYXBlZDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gaWYoKHRoaXMubGlzdFthcmdzLmluZGV4XS5zdGF0dXM9PWZhbHNlKSYmKHRoaXMubGlzdFthcmdzLmluZGV4XS5lbXBsb3llZT09dGhpcy5MaXN0T2ZFbXBsb3llZVthcmdzLmluZGV4XSkpXG4gICAgICAgICAgICAvLyB7dGhpcy5saXN0W2FyZ3MuaW5kZXhdLnN0YXR1cz0hIHRoaXMubGlzdFthcmdzLmluZGV4XS5zdGF0dXM7XG4gICAgICAgICAgICAvLyAgICAgdGhpcy5pc1RhcGVkPXRydWU7fVxuICAgICAgICAgICAgLy9hbGVydChhcmdzLnZpZXcpO1xuICAgICAgICAgICAgdGhpcy5pc0FkZGVkPXRoaXMuc2VhcmNoQnlJZCh0aGlzLkxpc3RPZkVtcGxveWVlW2FyZ3MuaW5kZXhdLmlkKTtcbiAgICAgICAgICAgIGlmKHRoaXMuaXNBZGRlZD09LTEpXG4gICAgICAgICAgICB7dGhpcy5UYXJnZXRzLnB1c2godGhpcy5MaXN0T2ZFbXBsb3llZVthcmdzLmluZGV4XS5pZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jb3VudD10aGlzLlRhcmdldHMubGVuZ3RoO1xuICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5UYXJnZXRzLnNwbGljZSh0aGlzLmlzQWRkZWQsMSk7XG4gICAgICAgICAgICAgICAgYWxlcnQoe3RpdGxlOlwiUmVtaW5kXCIsbWVzc2FnZTp0aGlzLkxpc3RPZkVtcGxveWVlW2FyZ3MuaW5kZXhdLmZpcnN0bmFtZStcIiBcIit0aGlzLkxpc3RPZkVtcGxveWVlW2FyZ3MuaW5kZXhdLmxhc3RuYW1lK1wiIGlzIHJlbW92ZWRcIixva0J1dHRvblRleHQ6IFwiT0tcIn0pO1xuICAgICAgICAgICAgICAgIHRoaXMuY291bnQ9dGhpcy5UYXJnZXRzLmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgLy8gICAgYWxlcnQoJ0l0ZW0gd2l0aCBpbmRleDogJyArIGFyZ3MuaW5kZXggKyAnIHRhcHBlZCcpO1xuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIH1cbiAgICAgICAgc3VibWl0KHRleHQpIHtcbiAgICAgICAgICAgIGlmKHRleHQ9PScnKVxuICAgICAgICAgICB7IHRoaXMuRXJyb3JPdGhlcj10cnVlO31cbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgIHt0aGlzLm90aGVyID0gdGV4dDtcbiAgICAgICAgICAgIHRoaXMuRXJyb3JPdGhlcj1mYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXNldCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLkNvbnRleHQ9XCJFbXBsb3llZSA6XCI7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29udGV4dD0wO1xuICAgICAgICAgICAgdGhpcy5vdGhlcj0nJztcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRUeXBlPTA7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTW9kZT0wO1xuICAgICAgICAgICAgdGhpcy5mZWVkYmFjay52YWx1ZT0nJztcbiAgICAgICAgICAgIHRoaXMucmVzZXRUYXJnZXRzKCk7XG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkQ29udGV4dFR5cGU9MDtcbiAgICAgICAgICAgIHRoaXMuT3RoZXI9ZmFsc2U7XG4gICAgICAgIFxuICAgICAgICAgICAgdGhpcy5Db250ZXh0cz1bXTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yKGxldCBpPTA7aTw9dGhpcy5MaXN0T2ZFbXBsb3llZS5sZW5ndGg7aSsrKVxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuQ29udGV4dHMucHVzaCh0aGlzLkxpc3RPZkVtcGxveWVlW2ldLmZpcnN0bmFtZStcIiBcIit0aGlzLkxpc3RPZkVtcGxveWVlW2ldLmxhc3RuYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHB1Ymxpc2goKVxuICAgICAgICB7IGlmKHRoaXMuZmVlZGJhY2suY29udGV4dFR5cGU9PSdPdGhlcicpXG4gICAgICAgIHt0aGlzLmZlZWRiYWNrLmNvbnRleHQ9dGhpcy5vdGhlcjt9XG4gICAgICAgICAgICBsZXQgZGF0ZT1uZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbGV0IGRheT1kYXRlLmdldERhdGUoKTtcbiAgICAgICAgICAgIGxldCBtb250aD1kYXRlLmdldE1vbnRoKCkrMTtcbiAgICAgICAgICAgIGxldCB5ZWFyPWRhdGUuZ2V0RnVsbFllYXIoKTtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2suZGF0ZT1kYXkrJy8nK21vbnRoKycvJyt5ZWFyO1xuICAgICAgICAgICAvLyB0aGlzLlRhcmdldHMucHVzaCh0aGlzLkVtcGxveWVlU2VydmljZS5nZXRFbXBsb3llZSgpKTtcbiAgICAgICAgICAgIHRoaXMuZmVlZGJhY2sudGFyZ2V0cz10aGlzLlRhcmdldHM7XG4gICAgICAgICAgXG4gICAgICAgICAgICAvL3RoaXMuZmVlZGJhY2suY29udGV4dD10aGlzLm90aGVyO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvL3RoaXMuZmRwYi5pZF9lPXRoaXMuRW1wbG95ZWVTZXJ2aWNlLmdldEVtcGxveWVlKCk7XG4gICAgICAgICAgICB0aGlzLmlzQnVzeT10cnVlO1xuICAgICAgICAgICAgdGhpcy5GZWVkYmFja1NlcnZpY2UuYWRkRmVlZGJhY2sodGhpcy5mZWVkYmFjaykuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgIG5leHQ9Pnt0aGlzLmlzQnVzeT1mYWxzZTsgXG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBhbGVydChcIllvdXIgZmVlZGJhY2sgaXMgYWRkZWQgc3VjY2Vzc2Z1bGx5XCIpO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoSlNPTi5zdHJpbmdpZnkobmV4dCkpO30sXG4gICAgICAgICAgICAgICAgZXJyb3I9PiB7dGhpcy5pc0J1c3k9ZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIGFsZXJ0KFwiVW5mb3J0dW5hdGVseSB3ZSB3ZXJlIHVuYWJsZSB0byBhZGQgeW91ciBmZWVkYmFjay5cIik7fVxuICAgICAgICAgICAgKVxuICAgICAgICAgIFxuICAgICAgICB9XG4gICAgICAgIGZpbmlzaCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHRoaXMuTGlzdD1mYWxzZTtcbiAgICAgICAgICAgIGlmKHRoaXMuVGFyZ2V0cy5sZW5ndGg9PTApXG4gICAgICAgICAgICB7dGhpcy5zZWxlY3RlZE1vZGU9MDtcbiAgICAgICAgICAgICAgICBmb3IobGV0IGk9MDtpPD10aGlzLkxpc3RPZkVtcGxveWVlLmxlbmd0aDtpKyspXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgdGhpcy5UYXJnZXRzLnB1c2godGhpcy5MaXN0T2ZFbXBsb3llZVtpXS5pZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge3RoaXMuc2VsZWN0ZWRNb2RlPTI7XG4gICAgICAgICAgICAvLyB0aGlzLmZlZWRiYWNrLnRhcmdldHM9dGhpcy5UYXJnZXRzXG4gICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXNldFRhcmdldHMoKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLlRhcmdldHM9W3RoaXMuRW1wbG95ZWVTZXJ2aWNlLmdldEVtcGxveWVlKCldO1xuICAgICAgICAgICAgdGhpcy5jb3VudD10aGlzLlRhcmdldHMubGVuZ3RoO1xuICAgICAgICB9XG5cbiAgICAgICBzZWFyY2hCeUlkKGlkOm51bWJlcil7XG4gICAgICAgICAgIGxldCBpOm51bWJlcj0wO1xuICAgICAgICAgICB3aGlsZSgodGhpcy5UYXJnZXRzW2ldIT1pZCkmJihpPD10aGlzLlRhcmdldHMubGVuZ3RoKSlcbiAgICAgICAgICB7IGkrKzt9XG4gICAgICAgICAgaWYoaT50aGlzLlRhcmdldHMubGVuZ3RoKVxuICAgICAgICAgIHtyZXR1cm4gLTE7fVxuICAgICAgICAgIGVsc2VcbiAgICAgICAgIHsgcmV0dXJuIGk7fVxuXG4gICAgICAgfVxuICAgICAgICAvLyAgcHVibGljIG9uVGV4dENoYW5nZShhcmdzOlRleHRGaWVsZCkge1xuICAgICAgICAvLyBpZih0aGlzLmlucHV0Lm90aGVyPT1cIlwiKVxuICAgICAgICAvLyAgICAgdGhpcy5FcnJvck90aGVyPXRydWU7XG4gICAgICAgIC8vICAgICBlbHNlXG4gICAgICAgIC8vICAgIHRoaXMuRXJyb3JPdGhlcj1mYWxzZTtcbiAgICAgICAgLy8gfVxufSJdfQ==